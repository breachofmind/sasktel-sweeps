<% include ../common/head.ejs %>

<header id="AdminHeader">
    <div class="container">
        <h1>Admin</h1>

        <div id="User" class="user-container">
            <p>Welcome <strong><%= request.user.first_name; %></strong></p>
            <a href="/logout">Logout</a>
        </div>
    </div>
</header>

<main class="container">

    <div id="AdminTable" class="table-area" ng-controller="adminCtrl" ng-class="{loading:loading}">

        <div id="AdminTableActions" class="action-row">
            <a href="/api/v1/submission/report" target="_blank" class="btn btn-primary">Generate Report</a>

            <div class="date-input">
                <small>Start date</small>
                <input type="datetime" class="form-control" ng-model="dateStart" format="yyyy-MM-dd" date-time view="date" min-view="date"/>
            </div>

            <div class="date-input">
                <small>End date</small>
                <input type="datetime" class="form-control" ng-model="dateEnd" format="yyyy-MM-dd" date-time view="date" min-view="date"/>
            </div>


        </div>

        <table class="table">
            <thead>
            <tr>
                <th class="td-small">Accept</th>
                <th>Submitted Date</th>
                <th>Sale Date</th>
                <th>Type</th>
                <th>Customer Name</th>
                <th>Manager</th>
                <th></th>
            </tr>
            </thead>

            <tbody ng-repeat="item in submissions" class="table-item" ng-class="{pending:item.pending, accepted:item.accepted, 'not-accepted':!item.accepted && !item.pending, open:item.open}">
                <tr class="table-item-data">
                    <td class="td-small">
                        <div class="custom-controls">
                            <input type="radio" id="rb1{{item.id}}" name="rb{{item.id}}" ng-value="false" ng-model="item.accepted" ng-change="itemAccept(item)">
                            <label for="rb1{{item.id}}" class="radio-null"><i class="mico accept" title="Deny">thumb_down</i></label>

                            <input type="radio" id="rb2{{item.id}}" name="rb{{item.id}}" ng-value="true" ng-model="item.accepted" ng-change="itemAccept(item)">
                            <label for="rb2{{item.id}}" class="radio-true"><i class="mico accept" title="Approve">thumb_up</i></label>
                            <i class="mico new-flag" title="New! Pending Approval">star</i>
                        </div>
                    </td>
                    <td>{{item.created_at}}</td>
                    <td>{{item.sale_date}}</td>
                    <td>{{item.type}}</td>
                    <td>{{item.customer_name}}</td>
                    <td>{{item.manager_id._title}}</td>
                    <td class="td-empty"><a href="javascript:;" class="mico" title="Details" ng-click="toggleItem(item)">menu</a></td>
                </tr>
                <tr ng-show="item.open">
                    <td colspan="7">
                        <p>{{item.details}}</p>
                        <p>{{item.sales_assoc_id._title}}</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="table-message" ng-show="!submissions.length && !loading">
            <div class="alert alert-info">
                <p>No submissions yet...</p>
            </div>
        </div>
        <i class="mico loader">cached</i>
    </div>

</main>


<% include ../common/footer.ejs %>